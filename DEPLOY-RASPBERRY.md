# üçì –î–µ–ø–ª–æ–π –Ω–∞ Raspberry Pi

–ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ Todo Veronika –Ω–∞ Raspberry Pi —Å –Ω—É–ª—è.

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Raspberry Pi (–ª—é–±–∞—è –º–æ–¥–µ–ª—å, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 4GB+ RAM)
- Raspbian OS (–∏–ª–∏ –ª—é–±–∞—è Debian-based —Å–∏—Å—Ç–µ–º–∞)
- –î–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
- SSH –¥–æ—Å—Ç—É–ø (–∏–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é)

## üöÄ –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä—è–º–æ –Ω–∞ Raspberry Pi

1. –ü–æ–¥–∫–ª—é—á–∏—Å—å –∫ Raspberry Pi (SSH –∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é)
2. –°–∫–∞—á–∞–π —Å–∫—Ä–∏–ø—Ç:
   ```bash
   curl -O https://raw.githubusercontent.com/vsevolodm12/todoveronika/main/deploy-raspberry-full.sh
   ```
   
   –ò–ª–∏ —Å–∫–æ–ø–∏—Ä—É–π —Ñ–∞–π–ª `deploy-raspberry-full.sh` –Ω–∞ Raspberry Pi

3. –°–¥–µ–ª–∞–π —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:
   ```bash
   chmod +x deploy-raspberry-full.sh
   ```

4. –ó–∞–ø—É—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–∫—É:
   ```bash
   ./deploy-raspberry-full.sh
   ```

5. –ñ–¥–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (5-10 –º–∏–Ω—É—Ç)

### –í–∞—Ä–∏–∞–Ω—Ç 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞

–ï—Å–ª–∏ —É —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å —Å–æ–±—Ä–∞–Ω–Ω—ã–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ª–æ–∫–∞–ª—å–Ω–æ:

1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π `deploy-raspberry.sh`:
   - –£–∫–∞–∂–∏ `SERVER_HOST` (IP –∏–ª–∏ hostname Raspberry Pi)
   - –£–∫–∞–∂–∏ `SERVER_USER` (–æ–±—ã—á–Ω–æ `pi`)

2. –ó–∞–ø—É—Å—Ç–∏:
   ```bash
   chmod +x deploy-raspberry.sh
   ./deploy-raspberry.sh
   ```

## ‚öôÔ∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç

1. ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º—É
2. ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Node.js 20.x
3. ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç PM2
4. ‚úÖ –ö–ª–æ–Ω–∏—Ä—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
5. ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
6. ‚úÖ –°–æ–±–∏—Ä–∞–µ—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
7. ‚úÖ –°–æ–∑–¥–∞–µ—Ç .env —Ñ–∞–π–ª
8. ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç —á–µ—Ä–µ–∑ PM2
9. ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
10. ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç (–µ—Å–ª–∏ —É–ø–∞–ª - –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è)

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç:

- **PM2 –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫** - —á–µ—Ä–µ–∑ `pm2 startup systemd`
- **Crontab** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- **rc.local** - –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã
- **Systemd service** - —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (–Ω–µ –∞–∫—Ç–∏–≤–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

### –ï—Å–ª–∏ —Å–≤–µ—Ç –≤—ã–∫–ª—é—á–∏–ª–∏

–ü–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è –ø–∏—Ç–∞–Ω–∏—è:
- –°–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è
- rc.local –∑–∞–ø—É—Å—Ç–∏—Ç —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
- PM2 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã
- –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫ - crontab –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç

## üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–º

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –°—Ç–∞—Ç—É—Å
pm2 status

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
pm2 logs todo-veronika

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
pm2 restart todo-veronika

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
pm2 stop todo-veronika

# –ó–∞–ø—É—Å–∫
pm2 start todo-veronika
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
cd ~/todoveronika
git pull origin main
npm run build
pm2 restart todo-veronika
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å PM2 –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
pm2 startup

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å crontab
crontab -l

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å rc.local
cat /etc/rc.local
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ–≤–µ—Ä—å:

1. **–°—Ç–∞—Ç—É—Å PM2:**
   ```bash
   pm2 status
   ```
   –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `todo-veronika | online`

2. **Health endpoint:**
   ```bash
   curl http://localhost:3001/health
   ```
   –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: `{"status":"ok","timestamp":...}`

3. **–õ–æ–≥–∏:**
   ```bash
   pm2 logs todo-veronika --lines 20
   ```
   –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫

4. **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:**
   ```bash
   # –£–∑–Ω–∞–π IP –∞–¥—Ä–µ—Å
   hostname -I
   
   # –û—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ
   http://–¢–í–û–ô_IP:3001
   ```

## üõ†Ô∏è –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –°–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏
pm2 logs todo-veronika

# –ü—Ä–æ–≤–µ—Ä—å .env —Ñ–∞–π–ª
cat ~/todoveronika/.env

# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –ø–æ—Ä—Ç —Å–≤–æ–±–æ–¥–µ–Ω
sudo netstat -tulpn | grep 3001
```

### PM2 –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

```bash
# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
pm2 startup systemd -u $USER --hp $HOME
pm2 save
```

### –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å systemd –≤–º–µ—Å—Ç–æ PM2

```bash
# –ê–∫—Ç–∏–≤–∏—Ä—É–π systemd service
sudo systemctl enable todo-veronika
sudo systemctl start todo-veronika

# –û—Å—Ç–∞–Ω–æ–≤–∏ PM2
pm2 stop todo-veronika
pm2 delete todo-veronika
```

## üìù –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram:

1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π `.env`:
   ```bash
   nano ~/todoveronika/.env
   ```

2. –ò–∑–º–µ–Ω–∏ –∑–Ω–∞—á–µ–Ω–∏—è:
   ```
   TELEGRAM_BOT_TOKEN=—Ç–≤–æ–π_—Ç–æ–∫–µ–Ω
   TELEGRAM_CHAT_ID=—Ç–≤–æ–π_chat_id
   ALLOWED_USER_IDS=—Ç–≤–æ–π_user_id
   ```

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏:
   ```bash
   pm2 restart todo-veronika
   ```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- `.env` —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - –Ω–µ –∫–æ–º–º–∏—Ç—å –≤ git!
- PM2 –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ—Ç —Ç–≤–æ–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–µ root)
- Systemd service —Ç–∞–∫–∂–µ –æ—Ç —Ç–≤–æ–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–æ—Ä—Ç 3001 –æ—Ç–∫—Ä—ã—Ç —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ (–¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –Ω—É–∂–µ–Ω nginx)

## üåê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –¥–æ—Å—Ç—É–ø –∏–∑–≤–Ω–µ:

1. –£—Å—Ç–∞–Ω–æ–≤–∏ nginx:
   ```bash
   sudo apt-get install nginx
   ```

2. –ù–∞—Å—Ç—Ä–æ–π reverse proxy (—Å–º. –æ—Å–Ω–æ–≤–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ –¥–µ–ø–ª–æ—é)

3. –ù–∞—Å—Ç—Ä–æ–π SSL —á–µ—Ä–µ–∑ certbot

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏: `pm2 logs todo-veronika`
2. –ü—Ä–æ–≤–µ—Ä—å —Å—Ç–∞—Ç—É—Å: `pm2 status`
3. –ü—Ä–æ–≤–µ—Ä—å .env —Ñ–∞–π–ª
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏: `pm2 restart todo-veronika`

